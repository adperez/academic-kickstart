---
title: "Data Visualization"
date: "Week 7"
output:
  rmdformats::readthedown:
    highlight: kate
css: custom.css
---

<style type="text/css">

body{ /* Normal  */
      font-size: 26px;
      line-height: 1.2;
  }
p{ /* Normal  */
      font-size: 26px;
      line-height: 1.2;
  }
 li{ /* Normal  */
      font-size: 24px;
      line-height: 1.2;
       padding: 5px 0px;
  }
td {  /* Table  */
  font-size: 8px;
}
h1.title {
  font-size: 38px;

}
h1 { /* Header 1 */
  font-size: 48px;

}
h2 { /* Header 2 */
    font-size: 36px;

}
h3 { /* Header 3 */
  font-size: 30px;


}

h4 { /* Header 4 */
  font-size: 28px;


}

code.r{ /* Code block */
    font-size: 40px;
}
pre { /* Code block - determines code spacing between lines */
    font-size: 18px;
}
</style>

```{r setup, echo=FALSE, cache=FALSE, warning = F, message = F}
library(knitr)
library(rmdformats)

## Global options
options(max.print="40")
opts_chunk$set(echo=FALSE,
	             cache=TRUE,
               prompt=FALSE,
               tidy=TRUE,
               comment=NA,
               message=FALSE,
               warning=FALSE)
opts_knit$set(width=75)
```


```{r, echo = F,cache=FALSE, warning = F, message = F}
library(knitr)
library(formatR)
opts_chunk$set(tidy.opts=list(width.cutoff=70),tidy=TRUE)

```

## Aims

How to present data clearly  

Introduce **ggplot2**  

Graphs

* Scatterplots
* Histograms
* Boxplots
* Error bar charts
* Line graphs

## The Art of Presenting Data

**Graphs should (Tufte, 2001):**  

Show the data  

Induce the reader to think about the data being presented (rather than some other aspect of the graph)  

Avoid distorting the data  

Present many numbers with minimum ink  

Make large data sets (assuming you have one) coherent  

Encourage the reader to compare different pieces of data  
Reveal data 

### Why Is This Graph Bad?

![](images/week7/image1.png)


### Why Is This Graph Better?

![](images/week7/image2.png)

## Deceiving the Reader
![](images/week7/image3.png)

## ggplot2

![](images/week7/image4.png)



## Simple Scatterplot

First create your base graph, telling ggplot2 your variables and dataset. 

```{r, eval = F, echo = T}
scatter <- ggplot(examData, aes(Anxiety, Exam))
```

Now we can add on. We want points (and will add a smoother):

```{r, eval = F, echo = T}
scatter + geom_point() + geom_smooth() + 
  
  labs(x = "Exam Anxiety", y = "Exam Performance %")

```

![](images/week7/image5.png)



## Simple Scatterplot With Regression Line

We will use the same *scatter* baseline plot object, and add onto it to add a regression line.

```{r, eval = F, echo = T}
scatter + geom_point() + 
  
  geom_smooth(method = "lm", colour = "Red")+ 
  
  labs(x = "Exam Anxiety", y = "Exam Performance %")

```

![](images/week7/image6.png)

## Grouped Scatterplot

Let's say we also want to visualize the gender breakdown of anxiety and performance. We can add the *colour* argument to our *scatter* object:

```{r, eval = F, echo = T}
scatter <- ggplot(examData, aes(Anxiety, Exam, colour = Gender))

```

And we add Gender to our *fill* (to fill different colored lines/dots by gender) and to our *colour* label to create a legend:

```{r, eval = F, echo = T}
scatter + geom_point() + 
  
  geom_smooth(method = "lm", aes(fill = Gender), alpha = 0.1) + 
  
  labs(x = "Exam Anxiety", y = "Exam Performance %", colour = "Gender") 

```

![](images/week7/image7.png)

## Histograms: Spotting Obvious Mistakes

Histograms plot:

* The score (x-axis)
* The frequency (y-axis)

Histograms help us to identify:

* The shape of the distribution
  + Skew
  + Kurtosis
  + Spread or variation in scores
* Unusual scores


## Histograms: Example

A biologist was worried about the potential health effects of music festivals  

Went to Download Music Festival  

Measured the hygiene of 810 concert-goers over the three days of the festival  

Hygiene was measured using a standardized technique: Score ranged from 0 to 4

* 0 = you smell like a corpse rotting up a skunk’s bum
* 4 = you smell of sweet roses on a fresh spring day

### Histogram of Hygiene Scores for Day 1

Create the plot object:

```{r, eval = F, echo = T}
festivalHistogram <- ggplot(festivalData, aes(day1)) +
  
  opts(legend.position = "none")
```

Add the graphical layer:

```{r, eval = F, echo = T}
festivalHistogram + geom_histogram(binwidth = 0.4 ) +
  
  labs(x = "Hygiene (Day 1 of Festival)", y = "Frequency")
```

![](images/week7/image8.png)

## Boxplots (Box-Whisker Diagrams)

Boxplots are made up of a box and two whiskers  

The box shows:

* The median
* The upper and lower quartile
* The limits within which the middle 50% of scores lie

The whiskers show:

* The range of scores
* The limits within which the top and bottom 25% of scores lie

![](images/week7/image9.png)

## Grouped Boxplot

To make a boxplot of the day 1 hygiene scores for males and females, set the variable **Gender** as an aesthetic  
Specify **Gender** to be plotted on the x-axis, and hygiene scores (**day1**) to be the variable plotted on the y-axis:

Create the plot object:

```{r, eval = F, echo = T}
festivalBoxplot <- ggplot(festivalData, aes(gender, day1))
```

Add the graphical layer:

```{r, eval = F, echo = T}
festivalBoxplot + geom_boxplot() + 
  
  labs(x = "Gender", y = "Hygiene (Day 1 of Festival)")
```

![](images/week7/image10.png)

## Error Bar Charts

The bar (usually) shows the mean score  

The error bar sticks out from the bar like a whisker  

The error bar displays the precision of the mean in one of three ways:

* The confidence interval (usually 95%)
* The standard deviation
* The standard error of the mean

## Bar Chart: One Independent Variable

*Is there such a thing as a ‘chick flick’?*  

Participants:

* 20 men
* 20 women

Half of each sample saw one of two films (IV):

* A ‘chick flick’ (Bridget Jones’s Diary), 
* Control (Memento)

Outcome measure (DV)
* Physiological arousal as an indicator of how much they enjoyed the film  


To plot the mean arousal score (y-axis) for each film (x-axis) first create the plot object: 

```{r, eval = F, echo = T}
bar <- ggplot(chickFlick, aes(film, arousal))
```

To add the mean, displayed as bars, we can add this as a layer to bar using the *stat_summary()* function:
```{r, eval = F, echo = T}
bar + stat_summary(fun.y = mean, geom = "bar", 
                   fill = "White", colour = "Black" 
```

![](images/week7/image11.png)

## Bar Chart: Two Independent Variables

Now, we want to see if gender plays a role in this  

First create the plot object (adding *fill* of gender): 

```{r, eval = F, echo = T}
bar <- ggplot(chickFlick, aes(film, arousal, fill = gender))
```

Next we create the graphical layer:
```{r, eval = F, echo = T}
bar + stat_summary(fun.y = mean, geom = "bar", position="dodge") + 
  
  stat_summary(fun.data = mean_cl_normal, geom = "errorbar", 
               
               position = position_dodge(width = 0.90), width = 0.2) + 
  
  labs(x = "Film", y = "Mean Arousal", fill = "Gender")
```

![](images/week7/image12.png)

## Line Graphs: One Independent Variable

*How to cure hiccups?*  

Participants:

* 15 hiccup sufferers

Each tries four interventions (in random order):

* Baseline
* Tongue-pulling manoeuvres
* Massage of the carotid artery
* Digital rectal massage

Outcome measure

* The number of hiccups in the minute after each procedure  

We can then create the line graph by executing the following commands:

```{r, eval = F, echo = T}
line <- ggplot(hiccups, aes(Intervention_Factor, Hiccups))
```

```{r, eval = F, echo = T}
line + stat_summary(fun.y = mean, geom = "point") +
  
  stat_summary(fun.y = mean, geom = "line", aes(group = 1),
               colour = "Red", linetype = "dashed") +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar", width = 0.2) + 
  labs(x = "Intervention", y = "Mean Number of Hiccups")
```

![](images/week7/image13.png)

## Line Graphs for Several Independent Variables

*Is text-messaging bad for your grammar?*  

Participants:

* 50 children

Children split into two groups:

* Text-messaging allowed
* Text-messaging forbidden

Each child measures at two points in time:
* Baseline
* 6 months later

Outcome measure
* Percentage score on a grammar test

We can then create the line graph by executing the following commands:

```{r, eval = F, echo = T}
line <- ggplot(textMessages, aes(Time, Grammar_Score, colour = Group))
```

```{r, eval = F, echo = T}
line + stat_summary(fun.y = mean, geom = "point") + stat_summary(fun.y = mean, geom = "line", aes(group = Group)) + 
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar", width = 0.2) + 
  labs(x = "Time", y = "Mean Grammar Score", colour = "Group") 

```

![](images/week7/image14.png)

